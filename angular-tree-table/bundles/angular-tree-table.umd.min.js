!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("moment"),require("file-saver"),require("xlsx"),require("@angular/forms"),require("@angular/common")):"function"==typeof define&&define.amd?define("angular-tree-table",["exports","@angular/core","moment","file-saver","xlsx","@angular/forms","@angular/common"],e):e((t=t||self)["angular-tree-table"]={},t.ng.core,t.moment_,t.fileSaver,t.xlsx,t.ng.forms,t.ng.common)}(this,(function(t,e,a,n,o,r,l){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */function i(t){var e="function"==typeof Symbol&&Symbol.iterator,a=e&&t[e],n=0;if(a)return a.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function s(t,e){var a="function"==typeof Symbol&&t[Symbol.iterator];if(!a)return t;var n,o,r=a.call(t),l=[];try{for(;(void 0===e||e-- >0)&&!(n=r.next()).done;)l.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(o)throw o.error}}return l}var d=function(){function t(){}return t.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],t.ctorParameters=function(){return[]},t.ngInjectableDef=e.ɵɵdefineInjectable({factory:function(){return new t},token:t,providedIn:"root"}),t}(),c=function(t,e,a,n){this.id=null,this.data={},this.expandable=!1,this.children=null,this.expanded=!1,this.clickablesContext=null,this.clickables={},this.styles={},this.classes=[],this.actions=[],this.selected=!1,this.options=[],this.id=t,this.data=e,this.expandable=a,this.children=n};var h=function(){this.context=null,this.extraInfos=[],this.showTableHeaders=!0,this.columnVisibility=!1,this.columnVisibilityDropDown=!1,this.visibleColumnFiltersVisibility=!1,this.visibleColumnFilters={},this.fullClassName="stacktable table-bordered large-only table table-sm",this.sortAscClassName="col-sort col-sort-asc",this.sortDescClassName="col-sort col-sort-desc",this.sortNothingClassName="col-sort col-sort-nothing",this.customClassName=null,this.showExpandArrows=!1,this.showExpandAllArrows=!1,this.showExpandAllEmptyChildren=!1,this.sortedColumn={},this.showPageLengthDropdown=!0,this.pageSizes=[10,25,50,100],this.level=0,this.columnFilters={},this.rowClickables={},this.rowClickablesContext=null,this.commonSearch=!0,this.excelExportButton=!1,this.excelExportFileName="ExportFile",this.excelExportButtonText="Excel Export",this.excelExportAllChildren=!0,this.excelExportOnlyExpanded=!1,this.events=new u};var u=function(){this.shouldRowExpand=null,this.rowExpanded=null,this.shouldRowCollapse=null,this.rowCollapsed=null};var g=function(){this.url=null,this.excelExportUrl=null,this.method=null,this.paramNames=new p,this.rowsKey="rows",this.totalRowsCountKey="totalRowsCount",this.filteredRowsCountKey="filteredRowsCount",this.rowUniqueKey=null};var p=function(){this.page="page",this.limit="limit",this.sort="sort",this.search="search",this.colSearch="colSearch",this.colFilters="colFilters",this.pageToken="pageToken"};var f=function(){function t(t,e,a){if(this.headers=[],this.data=[],this.isLoading=!1,this.keyword=null,this.page=1,this.pageSize=10,this.lastParams=null,this.totalRowsCount=0,this.filteredRowsCount=0,this.splashMessageFlag=!1,this.splashMessageContent="",this.tokens=[null],this.isAllRowsExpanded=!1,this.serverConfig=new g,this.config=new h,this.loadCounter=0,this.http=null,this.http=a,null!=e&&(void 0!==e.paramNames&&null!==e.paramNames||(e.paramNames=this.serverConfig.paramNames),void 0!==e.rowsKey&&null!==e.rowsKey||(e.rowsKey=this.serverConfig.rowsKey),void 0!==e.rowUniqueKey&&null!==e.rowUniqueKey||(e.rowUniqueKey=this.serverConfig.rowUniqueKey),this.serverConfig=e,this.loadData()),null!=t){if(void 0!==t.extraInfos&&null!==t.extraInfos&&(this.config.extraInfos=t.extraInfos),void 0!==t.context&&null!==t.context&&(this.config.context=t.context),void 0!==t.showTableHeaders&&null!==t.showTableHeaders&&(this.config.showTableHeaders=t.showTableHeaders),void 0!==t.showExpandArrows&&null!==t.showExpandArrows&&(this.config.showExpandArrows=t.showExpandArrows),void 0===t.events||null===t.events?t.events=this.config.events:(void 0!==t.events.rowExpanded&&null!==t.events.rowExpanded&&(this.config.events.rowExpanded=t.events.rowExpanded),void 0!==t.events.rowCollapsed&&null!==t.events.rowCollapsed&&(this.config.events.rowCollapsed=t.events.rowCollapsed)),void 0!==t.fullClassName&&null!==t.fullClassName&&(this.config.fullClassName=t.fullClassName),void 0!==t.excelExportFileName&&null!==t.excelExportFileName&&(this.config.excelExportFileName=t.excelExportFileName),void 0!==t.excelExportButtonText&&null!==t.excelExportButtonText&&(this.config.excelExportButtonText=t.excelExportButtonText),void 0!==t.sortAscClassName&&null!==t.sortAscClassName&&(this.config.sortAscClassName=t.sortAscClassName),void 0!==t.sortDescClassName&&null!==t.sortDescClassName&&(this.config.sortDescClassName=t.sortDescClassName),void 0!==t.sortNothingClassName&&null!==t.sortNothingClassName&&(this.config.sortNothingClassName=t.sortNothingClassName),void 0!==t.customClassName&&null!==t.customClassName&&(this.config.customClassName=t.customClassName),void 0!==t.showExpandAllArrows&&null!==t.showExpandAllArrows&&(this.config.showExpandAllArrows=t.showExpandAllArrows),void 0!==t.showExpandAllEmptyChildren&&null!==t.showExpandAllEmptyChildren&&(this.config.showExpandAllEmptyChildren=t.showExpandAllEmptyChildren),void 0!==t.showPageLengthDropdown&&null!==t.showPageLengthDropdown&&(this.config.showPageLengthDropdown=t.showPageLengthDropdown),void 0!==t.columnVisibility&&null!==t.columnVisibility&&(this.config.columnVisibility=t.columnVisibility),void 0!==t.columnVisibilityDropDown&&null!==t.columnVisibilityDropDown&&(this.config.columnVisibilityDropDown=t.columnVisibilityDropDown),void 0!==t.visibleColumnFiltersVisibility&&null!==t.visibleColumnFiltersVisibility&&(this.config.visibleColumnFiltersVisibility=t.visibleColumnFiltersVisibility),void 0!==t.sortedColumn&&null!==t.sortedColumn&&(this.config.sortedColumn=t.sortedColumn),void 0!==t.level&&null!==t.level&&(this.config.level=t.level),void 0!==t.commonSearch&&null!==t.commonSearch&&(this.config.commonSearch=t.commonSearch),void 0!==t.columnFilters&&null!==t.columnFilters&&(this.config.columnFilters=t.columnFilters),void 0!==t.pageSizes&&null!==t.pageSizes&&t.pageSizes.length>0){this.config.pageSizes.splice(0,this.config.pageSizes.length);for(var n=0;n<t.pageSizes.length;n++)t.pageSizes[n]>0&&this.config.pageSizes.push(t.pageSizes[n])}void 0!==t.visibleColumnFilters&&null!==t.visibleColumnFilters&&(this.config.visibleColumnFilters=t.visibleColumnFilters),void 0!==t.rowClickablesContext&&null!==t.rowClickablesContext&&(this.config.rowClickablesContext=t.rowClickablesContext),void 0!==t.rowClickables&&null!==t.rowClickables&&(this.config.rowClickables=t.rowClickables),void 0!==t.commonSearch&&null!==t.commonSearch&&(this.config.commonSearch=t.commonSearch),void 0!==t.excelExportButton&&null!==t.excelExportButton&&(this.config.excelExportButton=t.excelExportButton)}}return t.prototype.totalPagesCount=function(){var t=this.filteredRowsCount/this.pageSize;return Math.ceil(t)},t.prototype.getParams=function(){var t,e,a={};this.page-1>=0&&void 0!==this.tokens[this.page-1]&&null!==this.tokens[this.page-1]&&(a[this.serverConfig.paramNames.pageToken]=this.tokens[this.page-1]),a[this.serverConfig.paramNames.page]=this.page,a[this.serverConfig.paramNames.search]=this.keyword,a[this.serverConfig.paramNames.limit]=this.pageSize,a[this.serverConfig.paramNames.colFilters]=JSON.stringify(this.config.columnFilters),a[this.serverConfig.paramNames.sort]=JSON.stringify(this.config.sortedColumn);var n=Object.keys(this.config.visibleColumnFilters);try{for(var o=i(n),r=o.next();!r.done;r=o.next()){var l=r.value;null===this.config.visibleColumnFilters[l]&&delete this.config.visibleColumnFilters[l],void 0===this.config.visibleColumnFilters[l]&&delete this.config.visibleColumnFilters[l],""===this.config.visibleColumnFilters[l]&&delete this.config.visibleColumnFilters[l],""===this.config.visibleColumnFilters[l].trim()&&delete this.config.visibleColumnFilters[l]}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}return a[this.serverConfig.paramNames.colSearch]=JSON.stringify(this.config.visibleColumnFilters),a},t.prototype.loadExcelData=function(t){if(null!==this.serverConfig.excelExportUrl){var e=this.getParams(),a=this;a.isLoading=!0,"GET"===this.serverConfig.method&&this.http.get(this.serverConfig.excelExportUrl,{params:e,responseType:"blob"}).subscribe((function(t){a.isLoading=!1;var e=new Blob([t],{type:"application/vnd.ms-excel"});n.saveAs(e,"Orders.xlsx")}))}else console.warn("ExcelExportUrl not specified")},t.prototype.loadData=function(t){var e=this;if(null!==this.serverConfig.url){var a=this.getParams();if(void 0===this.lastParams||null===this.lastParams||this.lastParams!==JSON.stringify(a)){this.lastParams=JSON.stringify(a);var n=this;n.isLoading=!0,n.loadCounter++,"GET"===this.serverConfig.method&&this.http.get(this.serverConfig.url,{params:a}).subscribe((function(a){var o,r;if(null!=t){var l=[];if(void 0===a[e.serverConfig.rowsKey]||null===a[e.serverConfig.rowsKey])t([]),n.loadCounter--,n.loadCounter<=0&&(n.isLoading=!1,n.loadCounter=0);else{e.totalRowsCount=a[e.serverConfig.totalRowsCountKey],e.filteredRowsCount=a[e.serverConfig.filteredRowsCountKey];try{for(var s=i(a[e.serverConfig.rowsKey]),d=s.next();!d.done;d=s.next()){var h=d.value,u=null;u=void 0===e.serverConfig.rowUniqueKey||null===e.serverConfig.rowUniqueKey?(new Date).getTime():h[e.serverConfig.rowUniqueKey];var g=new c(u,h,!1,void 0);g.clickablesContext=e.config.rowClickablesContext,g.clickables=e.config.rowClickables,l.push(g)}}catch(t){o={error:t}}finally{try{d&&!d.done&&(r=s.return)&&r.call(s)}finally{if(o)throw o.error}}var p=a[e.serverConfig.rowsKey][a[e.serverConfig.rowsKey].length-1];null!=p&&void 0!==e.serverConfig.rowUniqueKey&&null!==e.serverConfig.rowUniqueKey&&(e.tokens[e.page]=p[e.serverConfig.rowUniqueKey]),t(l),n.loadCounter--,n.loadCounter<=0&&(n.isLoading=!1,n.loadCounter=0)}}else n.loadCounter--,n.loadCounter<=0&&(n.isLoading=!1,n.loadCounter=0)}),(function(t){n.loadCounter--,n.loadCounter<=0&&(n.isLoading=!1,n.loadCounter=0)}))}}else console.warn("URL not specified")},t.prototype.allRowsExpanded=function(){return!1},t.prototype.allRowsCollapsed=function(){return!1},t.prototype.splashMessage=function(t){this.splashMessageContent=t,this.splashMessageFlag=!0;var e=this;setTimeout((function(){e.splashMessageFlag=!1}),2e3)},t}();var b={NUMBER:"NUMBER",TEXT:"TEXT",DATE:"DATE",ACTIONS:"ACTIONS",SELECT:"SELECT",INPUT_TEXT:"INPUT_TEXT",INPUT_SELECT:"INPUT_SELECT"},w={BUTTON:0,LINK:1,TOGGLE_CHILD:2,TOGGLE_SELECT:3};w[w.BUTTON]="BUTTON",w[w.LINK]="LINK",w[w.TOGGLE_CHILD]="TOGGLE_CHILD",w[w.TOGGLE_SELECT]="TOGGLE_SELECT";var m=a,v=function(){function t(t){this.differs=t,this.tableData=new f,this.filteredData=[],this.className="",this.randomInstance=null,this.dropdownHideListenerAdded=!1,this.currentPageData=new f,this.json=null,this.extraInfoItemWidthPercent=100,this.rowSelectionChanged=new e.EventEmitter,this.inputRowSelectChanged=new e.EventEmitter,this.inputRowTextChanged=new e.EventEmitter,this.json=JSON}return t.prototype.ngOnInit=function(){this.validateData(),this.setPageData(this.tableData.page),this.className="table-tree level"+this.tableData.config.level,0===this.tableData.config.level&&console.warn("Initialize Search Functionality"),this.dataDiffers=this.differs.find(this.tableData).create(),this.columnFiltersDiffers=this.differs.find(this.tableData.config.columnFilters).create(),this.randomInstance=Math.floor(Math.random()*Math.floor(9999)),this.extraInfoItemWidthPercent=100/this.tableData.config.extraInfos.length,this.redefineTableDataFunctions()},t.prototype.redefineTableDataFunctions=function(){var t=this;this.tableData.allRowsCollapsed=function(){return t.currentPageData.data.length===t.currentPageData.data.filter((function(t){return!t.expanded})).length},this.tableData.allRowsExpanded=function(){return t.currentPageData.data.length===t.currentPageData.data.filter((function(t){return t.expanded})).length}},t.prototype.dataChanged=function(t){this.redefineTableDataFunctions(),this.setPageData(this.tableData.page)},t.prototype.refreshTable=function(){this.setPageData(this.tableData.page)},t.prototype.ngDoCheck=function(){var t=this.dataDiffers.diff(this.tableData);t&&this.dataChanged(t),(t=this.columnFiltersDiffers.diff(this.tableData.config.columnFilters))&&this.dataChanged(t),this.dropdownHideListenerAdded||$("#dropDownVisCon"+this.randomInstance).on("hide.bs.dropdown",(function(t){return(void 0===t.clickEvent||!$(t.clickEvent.target).hasClass("btnVis"))&&(this.dropdownHideListenerAdded=!0,!0)}))},t.prototype.expandRow=function(t){t.expanded=!0,null!==this.tableData.config.events.rowExpanded&&this.tableData.config.events.rowExpanded(t,this.tableData)},t.prototype.collapseRow=function(t){t.expanded=!1,this.tableData.isAllRowsExpanded=!1,null!==this.tableData.config.events.rowCollapsed&&this.tableData.config.events.rowCollapsed(t,this.tableData)},t.prototype.expandAllRows=function(){this.expandAllRowsInData(this.currentPageData.data),this.tableData.isAllRowsExpanded=!0},t.prototype.expandAllRowsInData=function(t){var e,a;try{for(var n=i(t),o=n.next();!o.done;o=n.next()){var r=o.value;r.expandable&&null!==r.children&&null!==r.children.data&&(this.tableData.config.showExpandAllEmptyChildren||r.children.data.length>0)&&(this.expandRow(r),this.expandAllRowsInData(r.children.data),r.children.isAllRowsExpanded=!0)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(a=n.return)&&a.call(n)}finally{if(e)throw e.error}}},t.prototype.collapseAllRows=function(){this.collapseAllRowsInData(this.currentPageData.data),this.tableData.isAllRowsExpanded=!1},t.prototype.collapseAllRowsInData=function(t){var e,a;try{for(var n=i(t),o=n.next();!o.done;o=n.next()){var r=o.value;r.expandable&&null!==r.children&&null!==r.children.data&&(this.tableData.config.showExpandAllEmptyChildren||r.children.data.length>0)&&(this.collapseRow(r),this.collapseAllRowsInData(r.children.data),r.children.isAllRowsExpanded=!1)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(a=n.return)&&a.call(n)}finally{if(e)throw e.error}}},t.prototype.toggleRow=function(t){t.expanded?this.collapseRow(t):this.expandRow(t)},t.prototype.rowAction=function(t,e){e.type===w.TOGGLE_CHILD&&this.toggleRow(t),void 0!==e.action&&null!==e.action&&e.action.bind(e.context,t.data,e)()},t.prototype.changePage=function(t){this.tableData.page===t||t<1||t>this.tableData.totalPagesCount()||(this.setPageData(t),this.collapseAllRows())},t.prototype.setPageData=function(t){var e=this;this.extraInfoItemWidthPercent=100/this.tableData.config.extraInfos.length;var a=this;if(void 0!==this.tableData.serverConfig.url&&null!==this.tableData.serverConfig.url){if(1!==t&&(t-1)*this.tableData.pageSize>this.tableData.totalRowsCount)return void console.warn("Invalid Page",(t-1)*this.tableData.pageSize,this.tableData.totalRowsCount);this.tableData.page=t,this.tableData.loadData((function(t){var n,o;a.filteredData.splice(0,e.filteredData.length);try{for(var r=i(t),l=r.next();!l.done;l=r.next()){var s=l.value;a.filteredData.push(s)}}catch(t){n={error:t}}finally{try{l&&!l.done&&(o=r.return)&&o.call(r)}finally{if(n)throw n.error}}a.filteredData.length;a.currentPageData.headers=a.tableData.headers;e.tableData.pageSize;void 0===e.currentPageData.data&&(e.currentPageData.data=[]),e.currentPageData.data.splice(0,e.currentPageData.data.length);for(var d=0;d<parseInt(e.tableData.pageSize+"",10);d++)null!==e.filteredData[d]&&void 0!==e.filteredData[d]&&e.currentPageData.data.push(e.filteredData[d])}))}else{if(a.tableData.totalRowsCount=a.tableData.data.length,1!==t&&(t-1)*this.tableData.pageSize>this.tableData.totalRowsCount)return void console.warn("Invalid Page",(t-1)*this.tableData.pageSize,this.tableData.totalRowsCount);this.tableData.page=t,this.filteredData.splice(0,this.filteredData.length),this.filteredData=this.tableData.data.filter((function(t){var a,n,o,r,l,s,d,c,h=Object.keys(t.data),u=!1;if(void 0!==e.tableData.keyword&&null!==e.tableData.keyword&&""!==e.tableData.keyword.trim())try{for(var g=i(h),p=g.next();!p.done;p=g.next()){var f=p.value;if(void 0!==t.data[f]&&null!==t.data[f]&&(u=t.data[f].toString().toLowerCase().indexOf(e.tableData.keyword.toLowerCase())>-1))break}}catch(t){a={error:t}}finally{try{p&&!p.done&&(n=g.return)&&n.call(g)}finally{if(a)throw a.error}}else u=!0;if(u&&void 0!==e.tableData.config.columnFilters&&null!==e.tableData.config.columnFilters)try{for(var b=i(h),w=b.next();!w.done;w=b.next()){f=w.value;if(void 0!==e.tableData.config.columnFilters[f]&&null!==e.tableData.config.columnFilters[f]&&Array.isArray(e.tableData.config.columnFilters[f])){if(void 0===t.data[f]||null===t.data[f]){u=!1;break}var m=!1;try{for(var v=(l=void 0,i(e.tableData.config.columnFilters[f])),D=v.next();!D.done;D=v.next()){var C=D.value;if(m=t.data[f].toString().toLowerCase().indexOf(C.toLowerCase())>-1)break}}catch(t){l={error:t}}finally{try{D&&!D.done&&(s=v.return)&&s.call(v)}finally{if(l)throw l.error}}if(!(u=m))break}}}catch(t){o={error:t}}finally{try{w&&!w.done&&(r=b.return)&&r.call(b)}finally{if(o)throw o.error}}if(u&&void 0!==e.tableData.config.visibleColumnFilters&&null!==e.tableData.config.visibleColumnFilters)try{for(var y=i(h),x=y.next();!x.done;x=y.next()){f=x.value;if(void 0!==e.tableData.config.visibleColumnFilters[f]&&null!==e.tableData.config.visibleColumnFilters[f]&&""!==e.tableData.config.visibleColumnFilters[f].trim()){if(void 0===t.data[f]||null===t.data[f]){u=!1;break}if(!(u=t.data[f].toString().toLowerCase().indexOf(e.tableData.config.visibleColumnFilters[f].toLowerCase())>-1))break}}}catch(t){d={error:t}}finally{try{x&&!x.done&&(c=y.return)&&c.call(y)}finally{if(d)throw d.error}}return u}));var n=a.filteredData.length;a.tableData.filteredRowsCount=n,a.currentPageData.headers=a.tableData.headers;var o=(t-1)*this.tableData.pageSize;void 0===this.currentPageData.data&&(this.currentPageData.data=[]),this.currentPageData.data.splice(0,this.currentPageData.data.length);for(var r=o;r<parseInt(o+"",10)+parseInt(this.tableData.pageSize+"",10);r++)null!==this.filteredData[r]&&void 0!==this.filteredData[r]&&this.currentPageData.data.push(this.filteredData[r])}},t.prototype.clickableClicked=function(t,e){"string"!=typeof t.clickables[e]||t.clickables[e]!==w.TOGGLE_CHILD.toString()?null!==t.clickablesContext?t.clickables[e].bind(t.clickablesContext,t.data,e)():t.clickables[e](t.data,e):this.toggleRow(t)},t.prototype.validateData=function(){console.warn("Data Schema need to be validated")},t.prototype.columnSearchChanged=function(t){this.setPageData(1)},t.prototype.pageNumbers=function(){for(var t=[],e=this.tableData.page-2;e<this.tableData.page;e++)e>0&&t.push(e);for(var a=2-t.length,n=this.tableData.page;n<=this.tableData.page+a+2;n++)n<=this.tableData.totalPagesCount()&&t.push(n);if(t.length<4)for(e=this.tableData.page-4;e<this.tableData.page-2;e++)e>0&&t.unshift(e);return t},t.prototype.exportExcelLocal=function(){var t,e,a,r,l=[];try{for(var s=i(this.tableData.data),d=s.next();!d.done;d=s.next()){var c=d.value,h={};try{for(var u=(a=void 0,i(this.tableData.headers)),g=u.next();!g.done;g=u.next()){var p=g.value;h[p.title]=c.data[p.dataProperty]}}catch(t){a={error:t}}finally{try{g&&!g.done&&(r=u.return)&&r.call(u)}finally{if(a)throw a.error}}l.push(h)}}catch(e){t={error:e}}finally{try{d&&!d.done&&(e=s.return)&&e.call(s)}finally{if(t)throw t.error}}var f={Sheets:{data:o.utils.json_to_sheet(l)},SheetNames:["data"]},b=o.write(f,{bookType:"xlsx",type:"array"}),w=new Blob([b],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});n.saveAs(w,this.tableData.config.excelExportFileName+".xlsx")},t.prototype.sortColumn=function(t){var e=t.dataProperty;void 0===this.tableData.config.sortedColumn[e]?(this.tableData.config.sortedColumn={},this.tableData.config.sortedColumn[e]="DESC",this.sortDescend(t)):"DESC"===this.tableData.config.sortedColumn[e]?(this.tableData.config.sortedColumn[e]="ASC",this.sortAscend(t)):delete this.tableData.config.sortedColumn[e]},t.prototype.sortAscend=function(t){var e=t.dataProperty;t.dataType===b.NUMBER?this.tableData.data.sort((function(t,a){return parseFloat(t.data[e])<parseFloat(a.data[e])?-1:parseFloat(t.data[e])>parseFloat(a.data[e])?1:0})):t.dataType===b.DATE?this.tableData.data.sort((function(t,a){return m(t.data[e]).toDate().getTime()<m(a.data[e]).toDate().getTime()?-1:m(t.data[e]).toDate().getTime()>m(a.data[e]).toDate().getTime()?1:0})):this.tableData.data.sort((function(t,a){return t.data[e]<a.data[e]?-1:t.data[e]>a.data[e]?1:0})),this.setPageData(this.tableData.page)},t.prototype.sortDescend=function(t){var e=t.dataProperty;t.dataType===b.NUMBER?this.tableData.data.sort((function(t,a){return parseFloat(t.data[e])<parseFloat(a.data[e])?1:parseFloat(t.data[e])>parseFloat(a.data[e])?-1:0})):t.dataType===b.DATE?this.tableData.data.sort((function(t,a){return m(t.data[e]).toDate().getTime()<m(a.data[e]).toDate().getTime()?1:m(t.data[e]).toDate().getTime()>m(a.data[e]).toDate().getTime()?-1:0})):this.tableData.data.sort((function(t,a){return t.data[e]<a.data[e]?1:t.data[e]>a.data[e]?-1:0})),this.setPageData(this.tableData.page)},t.prototype.search=function(){this.setPageData(1)},t.prototype.pageSizeChanged=function(){this.setPageData(1)},t.prototype.excelExportClicked=function(){void 0!==this.tableData.serverConfig&&null!==this.tableData.serverConfig&&void 0!==this.tableData.serverConfig.excelExportUrl&&null!==this.tableData.serverConfig.excelExportUrl?this.tableData.loadExcelData():this.exportExcelLocal()},t.prototype.getPageTo=function(){var t=this.tableData.pageSize*this.tableData.page;return t>this.tableData.filteredRowsCount&&(t=this.tableData.filteredRowsCount),t},t.prototype.isAllRowsSelected=function(t){return this.tableData.data.filter((function(t){return t.selected})).length===this.tableData.data.length},t.prototype.toggleSelectAllRows=function(t){this.isAllRowsSelected(t)?this.deselectAllRows(t):this.selectAllRows(t)},t.prototype.selectAllRows=function(t){this.tableData.data=this.tableData.data.map((function(t){return t.selected=!0,t})),this.updateHost()},t.prototype.deselectAllRows=function(t){this.tableData.data=this.tableData.data.map((function(t){return t.selected=!1,t})),this.updateHost()},t.prototype.toggleSelectRow=function(t){t.selected=!t.selected,this.updateHost()},t.prototype.getRowClass=function(t){var e,a,n={"expanded-row":t.expanded,"collapsed-row":!t.expanded,selected:"row.selected",unselected:"!row.selected"};try{for(var o=i(t.classes),r=o.next();!r.done;r=o.next()){n[r.value]=!0}}catch(t){e={error:t}}finally{try{r&&!r.done&&(a=o.return)&&a.call(o)}finally{if(e)throw e.error}}return n},t.prototype.getSelectedRows=function(){return function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(s(arguments[e]));return t}(this.tableData.data.filter((function(t){if(t.selected)return t.data}))).map((function(t){return t.data}))},t.prototype.childRowSelectionChanged=function(t){void 0!==this.rowSelectionChanged&&null!==this.rowSelectionChanged&&this.rowSelectionChanged.emit(t)},t.prototype.updateHost=function(){void 0!==this.rowSelectionChanged&&null!==this.rowSelectionChanged&&this.rowSelectionChanged.emit(this.getSelectedRows())},t.prototype.inputRowSelectChangedInternal=function(t,e,a,n,o){this.inputRowSelectChanged.emit({event:t,rowData:e,headerKey:a,value:n,level:o})},t.prototype.inputRowTextChangedInternal=function(t,e,a,n,o){this.inputRowTextChanged.emit({event:t,rowData:e,headerKey:a,value:n,level:o})},t.prototype.inputRowSelectChangedChild=function(t){this.inputRowSelectChanged.emit(t)},t.prototype.inputRowTextChangedChild=function(t){this.inputRowTextChanged.emit(t)},t.decorators=[{type:e.Component,args:[{selector:"angular-tree-table",template:'<div class="tree-table">\r\n  <div class="tree-table-loading" [ngClass]="tableData.isLoading ? \'on\' : \'off\'">\r\n    <div class="loader-msg">\r\n      Loading...\r\n    </div>\r\n  </div>\r\n  <div class="action-container">\r\n    <div class="search-section" *ngIf="tableData.config.showPageLengthDropdown || tableData.config.commonSearch || tableData.config.excelExportButton">\r\n      <div class="first-part" *ngIf="tableData.config.showPageLengthDropdown">\r\n        Show <select class="select-page-size form-control form-control-sm" [(ngModel)]="tableData.pageSize"\r\n          (change)="pageSizeChanged()">\r\n          <option value="{{p}}" *ngFor="let p of tableData.config.pageSizes">{{p}}</option>\r\n        </select> Entries\r\n      </div>\r\n      <div class="second-part">\r\n        <input *ngIf="tableData.config.commonSearch" type="text"\r\n          class="form-control form-control-sm text-center col-3 float-right" [(ngModel)]="tableData.keyword"\r\n          (keyup)="search()" (change)="search()" placeholder="Search" />\r\n        <button *ngIf="tableData.config.excelExportButton"\r\n          class="btn btn-sm btn-primary export excelExportButton float-right" (click)="excelExportClicked()">{{tableData.config.excelExportButtonText}}</button>\r\n        <div class="dropdown dropleft" id="dropDownVisCon{{randomInstance}}">\r\n          <button id="dropDownVis{{randomInstance}}" *ngIf="tableData.config.columnVisibilityDropDown"\r\n            class="btn btn-sm btn-secondary dropDownBtn v-elipses float-right dropdown-toggle" data-toggle="dropdown"\r\n            aria-haspopup="true" aria-expanded="false">⋮</button>\r\n            <div class="dropDownBtn-data dropdown-menu">\r\n              <button class="btnVis btn-sm btn" *ngFor="let header of currentPageData.headers"\r\n                [ngClass]="header.show ? \'active\': \'\'" (click)=" header.show = !header.show;">{{header.title}}</button>\r\n            </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div class="buttons-section" *ngIf="tableData.config.columnVisibility">\r\n      <div class="column-visibility" *ngIf="tableData.config.columnVisibility">\r\n        <button class="btnVis" *ngFor="let header of currentPageData.headers" [ngClass]="header.show ? \'active\': \'\'"\r\n          (click)="header.show = !header.show">{{header.title}}</button>\r\n      </div>\r\n    </div>\r\n    <div class="extraInfo-section" *ngIf="tableData.config.extraInfos.length > 0">\r\n      <div class="extraInfo" [style.width]="extraInfoItemWidthPercent + \'%\'" *ngFor="let exInfo of tableData.config.extraInfos">\r\n        {{exInfo[0]}}: {{exInfo[1]}}\r\n      </div>\r\n    </div>\r\n  </div>\r\n  <table [class]="className + \' \' + tableData.config.customClassName + \' \' + tableData.config.fullClassName">\r\n    <thead class="ds2-table-element--head-row thead-sm" *ngIf="tableData.config.showTableHeaders">\r\n      <tr>\r\n        <th *ngIf="!tableData.config.showExpandAllArrows" [ngClass]="tableData.config.showExpandArrows ? \'used\' : \'not-used\'"></th>\r\n        <th *ngIf="tableData.config.showExpandAllArrows" [ngClass]="tableData.config.showExpandArrows ? \'used\' : \'not-used\'">\r\n          <button class="btn btn-secondary btn-sm collapsed-row-button" (click)="expandAllRows()" \r\n                      *ngIf="!tableData.isAllRowsExpanded"></button>\r\n              <button class="btn btn-secondary btn-sm expanded-row-button" (click)="collapseAllRows()" \r\n                      *ngIf="tableData.isAllRowsExpanded"></button>\r\n        </th>\r\n        <ng-container *ngFor="let header of currentPageData.headers">\r\n          <th *ngIf="header.show && header.dataType !== \'SELECT\'" [ngClass]="header.style" (click)="sortColumn(header)">{{header.title}}\r\n            <i [ngClass]="tableData.config.sortAscClassName+\' sort-right-align\'" *ngIf="tableData.config.sortedColumn[header.dataProperty] === \'ASC\'"></i>\r\n            <i [ngClass]="tableData.config.sortDescClassName+\' sort-right-align\'" *ngIf="tableData.config.sortedColumn[header.dataProperty] === \'DESC\'"></i>\r\n            <i [ngClass]="tableData.config.sortNothingClassName+\' sort-right-align\'" *ngIf="tableData.config.sortedColumn[header.dataProperty] !== \'DESC\' && tableData.config.sortedColumn[header.dataProperty] !== \'ASC\'"></i>\r\n          </th>\r\n          <th *ngIf="header.show && header.dataType === \'SELECT\'" [ngClass]="header.style" (click)="toggleSelectAllRows(header)">\r\n            <input type="checkbox" class="header-check-box select-all" [checked]="isAllRowsSelected(header) ? \'checked\' : \'\'"/> {{header.title}}\r\n          </th>\r\n        </ng-container>\r\n      </tr>\r\n      <tr *ngIf="tableData.config.visibleColumnFiltersVisibility">\r\n        <th [ngClass]="tableData.config.showExpandArrows ? \'used\' : \'not-used\'"></th>\r\n        <ng-container *ngFor="let header of currentPageData.headers">\r\n          <th *ngIf="header.show">\r\n            <input type="text" class="form-control form-control-sm text-center" placeholder="{{header.title}}"\r\n              (change)="columnSearchChanged(header.dataProperty)" (keyup)="columnSearchChanged(header.dataProperty)"\r\n              [(ngModel)]="tableData.config.visibleColumnFilters[header.dataProperty]"\r\n              [disabled]="!header.enableColumnSearch || header.dataType === \'SELECT\'" [name]="\'filter_\'+header.dataProperty" />\r\n          </th>\r\n        </ng-container>\r\n      </tr>\r\n    </thead>\r\n    <tbody>\r\n      <ng-container *ngIf="currentPageData.data.length === 0">\r\n        <tr *ngIf="tableData.isLoading">\r\n          <td [ngClass]="tableData.config.showExpandArrows ? \'used\' : \'not-used\'"></td>\r\n          <td [attr.colspan]="currentPageData.headers.length + 1" style="text-align: center;">\r\n            Loading...\r\n          </td>\r\n        </tr>\r\n        <tr *ngIf="!tableData.isLoading">\r\n          <td [ngClass]="tableData.config.showExpandArrows ? \'used\' : \'not-used\'"></td>\r\n          <td [attr.colspan]="currentPageData.headers.length + 1" style="text-align: center;">\r\n            No records found\r\n          </td>\r\n        </tr>\r\n      </ng-container>\r\n      <ng-container *ngFor="let row of currentPageData.data; let indi = index;">\r\n        <ng-container *ngIf="row !== undefined">\r\n          <tr [ngClass]="getRowClass(row)">\r\n            <td *ngIf="!row.expandable" [ngClass]="tableData.config.showExpandArrows ? \'used\' : \'not-used\'"></td>\r\n            <td *ngIf="row.expandable" [ngClass]="tableData.config.showExpandArrows ? \'used\' : \'not-used\'">\r\n              <button class="btn btn-secondary btn-sm collapsed-row-button" (click)="expandRow(row)" \r\n                      *ngIf="!row.expanded"></button>\r\n              <button class="btn btn-secondary btn-sm expanded-row-button" (click)="collapseRow(row)" \r\n                      *ngIf="row.expanded"></button>\r\n            </td>\r\n            <ng-container *ngFor="let header of currentPageData.headers">\r\n              <td *ngIf="header.show" [style]="row.styles[header.dataProperty]"\r\n                [ngClass]="row.classes[header.dataProperty]">\r\n                <ng-container *ngIf="header.dataType === \'ACTIONS\'">\r\n                  <button class="tt-row-action  btn-xs btn btn-default" *ngFor="let action of row.actions"\r\n                    [ngClass]="action.classes" (click)="rowAction(row, action)" [title]="action.title">\r\n                    {{action.label}}\r\n                  </button>\r\n                </ng-container>\r\n                <ng-container *ngIf="header.dataType === \'SELECT\'">\r\n                  <input type="checkbox" class="header-check-box select-one" \r\n                         [checked]="row.selected ? \'checked\' : \'\'" \r\n                         (change)="toggleSelectRow(row)"/>\r\n                </ng-container>\r\n                <ng-container *ngIf="header.dataType === \'INPUT_TEXT\'">\r\n                  <input type="text" class="header-input-text tt-input-tag" [(ngModel)]="row.data[header.dataProperty]" [name]="indi + \'_\' + header.dataProperty" (change)="inputRowTextChangedInternal($event, row.data, header.dataProperty, row.data[header.dataProperty], tableData.config.level)"/>\r\n                </ng-container>\r\n                <ng-container *ngIf="header.dataType === \'INPUT_SELECT\'">\r\n                  <select class="header-input-select tt-select-tag" [(ngModel)]="row.data[header.dataProperty]" [name]="indi + \'_\' + header.dataProperty" (change)="inputRowSelectChangedInternal($event, row.data, header.dataProperty, row.data[header.dataProperty], tableData.config.level)">\r\n                    <ng-container *ngIf="row.options !== undefined && row.options !== null">\r\n                      <option [value]="opt.value" *ngFor="let opt of row.options">{{opt.displayText}}</option>\r\n                    </ng-container>\r\n                  </select>\r\n                </ng-container>\r\n                <ng-container *ngIf="header.dataType !== \'ACTIONS\' && header.dataType !== \'SELECT\'">\r\n                  <ng-container *ngIf="row.clickables[header.dataProperty] !== undefined">\r\n                    <button class="popup-link-button"\r\n                      (click)="clickableClicked(row, header.dataProperty)">{{row.data[header.dataProperty]}}</button>\r\n                  </ng-container>\r\n                  <ng-container *ngIf="row.clickables[header.dataProperty] === undefined && header.dataType !== \'INPUT_TEXT\' && header.dataType !== \'INPUT_SELECT\'">\r\n                    {{row.data[header.dataProperty]}}\r\n                  </ng-container>\r\n                </ng-container>\r\n              </td>\r\n            </ng-container>\r\n          </tr>\r\n          <tr *ngIf="row.expanded" [ngClass]="row.expanded ? \'expanded-row-content\' : \'collapsed-row-content\'">\r\n            <td style="width: 10px;"></td>\r\n            <td [colSpan]="currentPageData.headers.length">\r\n              <angular-tree-table (inputRowSelectChanged)="inputRowSelectChangedChild($event)" (inputRowTextChanged)="inputRowTextChangedChild($event)" (rowSelectionChanged)="childRowSelectionChanged($event)" [tableData]="row.children"></angular-tree-table>\r\n            </td>\r\n          </tr>\r\n        </ng-container>\r\n      </ng-container>\r\n    </tbody>\r\n  </table>\r\n  <div class="table-bottom">\r\n    <div class="page-number-status">\r\n      Showing {{(tableData.pageSize * (tableData.page - 1)) + 1}} to {{getPageTo()}} of\r\n      <ng-container *ngIf="tableData.filteredRowsCount != tableData.totalRowsCount">\r\n        {{tableData.filteredRowsCount}} rows filtered on {{tableData.totalRowsCount}}\r\n      </ng-container>\r\n      <ng-container *ngIf="tableData.filteredRowsCount === tableData.totalRowsCount">\r\n        {{tableData.filteredRowsCount}}\r\n      </ng-container>\r\n      rows\r\n    </div>\r\n    <div class="pagination-buttons" *ngIf="tableData.totalRowsCount > tableData.pageSize">\r\n      <div [class]="tableData.splashMessageFlag ? \'splash-message show\' : \'splash-message hide\'">\r\n        <div class="message-content">{{tableData.splashMessageContent}}</div>\r\n      </div>\r\n      <div class="btn btnGroup btn-group">\r\n        <button class="btn big" [class]="tableData.page === 1 ? \'btn big btn-secondary \' : \'btn big btn-secondary \'"\r\n          (click)="changePage(1)">First</button>\r\n        <button class="btn" [class]="\'btn btn-secondary\'" (click)="changePage(tableData.page - 1)">&lt;</button>\r\n        <ng-container *ngFor="let pageNumber of pageNumbers()">\r\n          <button class="btn" [class]="tableData.page === pageNumber ? \'btn btn-primary \' : \'btn btn-secondary \'"\r\n            (click)="changePage(pageNumber)">{{pageNumber}}</button>\r\n        </ng-container>\r\n        <button class="btn" [class]="\'btn btn-secondary\'" (click)="changePage(tableData.page + 1)">&gt;</button>\r\n        <button class="btn big"\r\n          [class]="tableData.page === tableData.totalPagesCount() ? \'btn big btn-secondary \' : \'btn big btn-secondary \'"\r\n          (click)="changePage(tableData.totalPagesCount())">Last</button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>',styles:[':host .dropDownBtn-data{overflow:visible;padding:5px}:host .tree-table-loading{width:100%;background-color:rgba(0,0,0,.5);overflow:auto;position:absolute}:host .tree-table-loading .loader-msg{color:#fff;font-weight:700;text-align:center;width:100%;height:100px;position:absolute;top:calc(50% - 50px)}:host .tree-table-loading.on{height:100%;z-index:1000}:host .tree-table-loading.off{height:0%}:host .tree-table{margin-top:10px;margin-bottom:10px;overflow:auto;position:relative}:host .tree-table .select-page-size{display:inline-block;width:auto}:host .tree-table .extraInfo-section .extraInfo{float:left}:host .tree-table .column-visibility{text-align:center}:host .tree-table .column-visibility .btnVis,:host .tree-table .dropDownBtn-data .btnVis{border-style:none;padding:7px;border-radius:2px;margin-right:5px;margin-bottom:5px}:host .tree-table .column-visibility .btnVis.active,:host .tree-table .column-visibility .btnVis.hover,:host .tree-table .column-visibility .btnVis:active,:host .tree-table .column-visibility .btnVis:hover,:host .tree-table .dropDownBtn-data .btnVis.active,:host .tree-table .dropDownBtn-data .btnVis.hover,:host .tree-table .dropDownBtn-data .btnVis:active,:host .tree-table .dropDownBtn-data .btnVis:hover{background-color:#666;color:#fff}:host .tree-table .action-container .btn{margin-right:5px}:host .tree-table .action-container .search-section{overflow:visible;margin-top:10px;margin-bottom:5px}:host .tree-table .action-container .search-section .first-part{width:40%;text-align:left;display:inline-block}:host .tree-table .action-container .search-section .second-part{width:60%;display:inline-block}:host .tree-table .table-bottom{overflow:auto}:host .tree-table .table-bottom .page-number-status{float:left;overflow:auto;padding-top:.375rem}:host .tree-table .table-bottom .btnGroup{float:right;padding-right:0;padding-top:0;padding-bottom:0}:host .tree-table .table-bottom .pagination-buttons{overflow:auto;position:relative}:host .tree-table .table-bottom .pagination-buttons .splash-message{float:right;position:absolute;right:0;z-index:9999;background:#ececec;border-radius:3px;color:#86adef;font-weight:700;padding:5.5px 15px;transition:opacity 1s ease-in-out}:host .tree-table .table-bottom .pagination-buttons .splash-message.show{opacity:1}:host .tree-table .table-bottom .pagination-buttons .splash-message.hide{padding:0;opacity:0}:host .tree-table .table-bottom .pagination-buttons button{width:48px}:host .tree-table .table-bottom .pagination-buttons button.big{width:50px}:host .tree-table table{width:100%;text-align:center;border-collapse:collapse;margin-bottom:5px}:host .tree-table table th{cursor:pointer;-moz-user-select:none;user-select:none;-ms-user-select:none;-webkit-user-select:none;font-weight:700}:host .tree-table table .expanded-row-content{background:0 0}:host .tree-table table tr>td:first-child.not-used,:host .tree-table table tr>th:first-child.not-used{display:none}:host .tree-table table tr>td:first-child.used,:host .tree-table table tr>th:first-child.used{width:50px}:host .tree-table table tr>td:first-child.used .collapsed-row-button:after,:host .tree-table table tr>th:first-child.used .collapsed-row-button:after{content:"";width:0;height:0;border-top:5px solid transparent;border-bottom:5px solid transparent;border-left:5px solid #fff;display:inline-block}:host .tree-table table tr>td:first-child.used .expanded-row-button:after,:host .tree-table table tr>th:first-child.used .expanded-row-button:after{content:"";width:0;height:0;border-left:5px solid transparent;border-right:5px solid transparent;border-top:5px solid #fff;display:inline-block}:host .tree-table table tr .tt-row-action{margin-right:5px}:host .tree-table table td button.popup-link-button{border-style:none!important;background:0 0!important;color:#86adef!important}']}]}],t.ctorParameters=function(){return[{type:e.KeyValueDiffers}]},t.propDecorators={tableData:[{type:e.Input}],rowSelectionChanged:[{type:e.Output}],inputRowSelectChanged:[{type:e.Output}],inputRowTextChanged:[{type:e.Output}]},t}();var D=function(){function t(){}return t.decorators=[{type:e.NgModule,args:[{declarations:[v],imports:[r.FormsModule,l.CommonModule],exports:[v]}]}],t}(),C=function(t,e,a,n){this.dataType=b.TEXT,this.enableColumnSearch=!0,this.dataProperty=e,this.title=t,this.style=a,this.show=n};var y=function(t,e,a,n){this.type=w.BUTTON,this.label=t,this.title=e,this.classes=a,this.action=n};t.AngularTreeTableComponent=v,t.AngularTreeTableModule=D,t.AngularTreeTableService=d,t.TreeTableData=f,t.TreeTableHeaderObject=C,t.TreeTableRow=c,t.TreeTableRowAction=y,t.TreeTableRowActionType=w,t.TtDataType=b,t.ɵa=h,t.ɵb=g,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=angular-tree-table.umd.min.js.map